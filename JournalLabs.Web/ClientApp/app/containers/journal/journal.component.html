<!--<a *ngIf="!isNewJournal" (click)="isNewJournal=true">Создать новый журнал (+)</a>--><!--Create new journal-->

<div class="row">
  <div *ngIf="journalViewModel!=null">
    <table>
      <thead>
        <tr>
          <td></td>
          <ng-container *ngFor=" let key of headerKindOfWorkBlock">
            <td style="text-align:center; vertical-align:middle;" colspan="2" >
              <input [(ngModel)]="key.kindOfWork.NameKindOfWork" (blur)="changeKindOfWorkName(key.kindOfWork)" [readonly]="studentId" />              
            </td>
            <td><input [(ngModel)]="key.isVisible" type="checkbox" (ngModelChange)="changeVisibleKindOfWork(key.kindOfWork.Id,$event)" /></td>
          </ng-container>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td *ngIf="currentRole=='Teacher'" style="padding-right: 10px;">Скрыть студента</td>
          <td *ngIf="currentRole=='Teacher'" style="padding-right: 10px;">Удалить студента</td>
          <td></td>
          <ng-container *ngFor=" let key of headerKindOfWork">
            <td *ngIf="key == kindOfMark.FirstMark">Дата сдачи</td><!--FirstDate-->
            <td *ngIf="key == kindOfMark.FirstMark">Оценка при первой сдаче</td><!--FirstMark-->
            <td *ngIf="key == kindOfMark.FirstMark">ФИО преподаватеяя</td><!--FirstMark-->
            <td *ngIf="key == kindOfMark.SecondMark">Дата пересдачи</td><!--SecondDate-->
            <td *ngIf="key == kindOfMark.SecondMark">Оценка при пересдаче</td><!--SecondMark-->
            <td *ngIf="key == kindOfMark.SecondMark">ФИО преподавателя</td><!--FirstMark-->
          </ng-container>
          <td>Итоговая оценка</td>
          <td>Описание</td>
        </tr>
        <ng-container *ngFor=" let key2 of journalViewModel.StudentResultForJournal;let i = index">
          <tr>
            <td *ngIf="currentRole=='Teacher'" style="padding-right: 10px;"><input type="checkbox" [(ngModel)]="key2.Remark.IsHideStudent" (ngModelChange)="changeRemark(key2.Remark)" /></td>
            <td *ngIf="currentRole=='Teacher'" style="padding-right: 10px;"><input type="button" (click)="removeStudent(key2.StudentLabBlocks[0].StudentId)" value="удалить" /></td>
            <td><input [(ngModel)]="key2.StudentInfo.StudentName" (blur)="changeUserName(key2.StudentInfo)" [readonly]="studentId" /></td>
            <ng-container *ngFor=" let key of key2.StudentLabBlocks">
              <td *ngIf="key.KindOfMark == kindOfMark.FirstMark"> <input [(ngModel)]="key.Date" (click)="key.Date=currentDate" (blur)="changeLabBlock(key)" [readonly]="key.MarkTeacherName!=null && (studentId || key.MarkTeacherId != currentTeacherId && currentRole!='Teacher')" /></td>
              <td *ngIf="key.KindOfMark == kindOfMark.FirstMark"> <input [(ngModel)]="key.Mark" (click)="key.Date=currentDate" (blur)="changeLabBlock(key)" [readonly]="key.MarkTeacherName!=null && (studentId || key.MarkTeacherId != currentTeacherId && currentRole!='Teacher')" type="number" [ngStyle]="{'background-color': key.Color != '' && !studentId ? key.Color : 'white'}" step="0.1" /></td>
              <td *ngIf="key.KindOfMark == kindOfMark.FirstMark"> <input [(ngModel)]="key.MarkTeacherName" readonly /></td>
              <td *ngIf="key.KindOfMark == kindOfMark.SecondMark"><input [(ngModel)]="key.Date" (click)="key.Date=currentDate" (blur)="changeLabBlock(key)" [readonly]="key.MarkTeacherName!=null && (studentId || key.MarkTeacherId != currentTeacherId && currentRole!='Teacher')" /></td>
              <td *ngIf="key.KindOfMark == kindOfMark.SecondMark"><input [(ngModel)]="key.Mark" (click)="key.Date=currentDate" (blur)="changeLabBlock(key)" [readonly]="key.MarkTeacherName!=null && (studentId || key.MarkTeacherId != currentTeacherId && currentRole!='Teacher')" type="number" [ngStyle]="{'background-color': key.Color != '' && !studentId ? key.Color : 'white'}" step="0.1" /></td>
              <td *ngIf="key.KindOfMark == kindOfMark.SecondMark"><input [(ngModel)]="key.MarkTeacherName" readonly /></td>
            </ng-container>
            <td><input value="{{totalMark(key2.StudentLabBlocks)}}" [readonly]="studentId" /></td>
            <td *ngIf="key2.Remark!=null"><input [(ngModel)]="key2.Remark.RemarkText" (blur)="changeRemark(key2.Remark)" [readonly]="studentId" /></td>
            <td *ngIf="key2.Remark==null"><input value="" [readonly]="studentId" /></td>
          </tr>
        </ng-container>
      </tbody>
    </table>
    <br />
    <input type="button" (click)="addStudentToJournal()" value="Добавить студента" />
    <br />
    <div *ngIf="currentRole=='Teacher'">
      <p>Aссистенты которые имеют доступ к журналу:</p><!--Input count lab blocks:-->
      <ul style="width: 300px; height: 200px; overflow: auto">
        <li *ngFor=" let assistant of assistantList"><input type="checkbox" (click)="changeAssistant($event,assistant)" [checked]="assistant.IsAllowAccess"> {{assistant.Name}}</li>
      </ul>
    </div>
  </div>
</div>
